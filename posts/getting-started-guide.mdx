---
title: "Python RPA å®æˆ˜ï¼šæ‰“é€ ä¼ä¸šçº§è‡ªåŠ¨åŒ–åŠå…¬åŠ©æ‰‹"
description: "ä»é›¶å¼€å§‹æ„å»º Python RPA ç³»ç»Ÿï¼šPyAutoGUI + Selenium + ä¼ä¸šçº§æ¶æ„è®¾è®¡ï¼Œè®©ä½ çš„åŠå…¬æ•ˆç‡æå‡10å€ï¼"
date: "2024-01-15"
author: "å¸…å¸…çš„å…³å…³"
tags: ["Python", "RPA", "PyAutoGUI", "Selenium", "å®æˆ˜"]
cover: "https://images.unsplash.com/photo-1552664730-d307ca884978?w=1200&h=630&fit=crop&crop=entropy&auto=format"
---

# Python RPA å®æˆ˜ï¼šæ‰“é€ ä¼ä¸šçº§è‡ªåŠ¨åŒ–åŠå…¬åŠ©æ‰‹

ä½ æ˜¯å¦ä¹Ÿæ›¾ç»æ¯å¤©é‡å¤ç€åŒæ ·çš„å·¥ä½œï¼šå¤åˆ¶ç²˜è´´æ•°æ®ã€å‘é€å›ºå®šæ ¼å¼çš„é‚®ä»¶ã€ç”ŸæˆæŠ¥è¡¨... ä»Šå¤©æˆ‘ä»¬å°±ç”¨ Python æ¥ç»ˆç»“è¿™äº›é‡å¤åŠ³åŠ¨ï¼

## ğŸ¯ ä»€ä¹ˆæ˜¯ RPAï¼Ÿ

RPA (Robotic Process Automation) æœºå™¨äººæµç¨‹è‡ªåŠ¨åŒ–ï¼Œç®€å•æ¥è¯´å°±æ˜¯ç”¨è½¯ä»¶æœºå™¨äººæ¥æ¨¡æ‹Ÿäººç±»çš„æ“ä½œã€‚

![RPA å·¥ä½œæµç¨‹](https://images.unsplash.com/photo-1460925895917-afdab827c52f?w=800&h=400&fit=crop&crop=entropy&auto=format)

### RPA çš„æ ¸å¿ƒä»·å€¼
- âš¡ **æ•ˆç‡æå‡**ï¼š7x24 å°æ—¶ä¸é—´æ–­å·¥ä½œ
- ğŸ¯ **é›¶é”™è¯¯ç‡**ï¼šæœºå™¨ä¸ä¼šç–²åŠ³ï¼Œä¸ä¼šå‡ºé”™
- ğŸ’° **æˆæœ¬é™ä½**ï¼šä¸€æ¬¡æŠ•å…¥ï¼Œé•¿æœŸå—ç›Š
- ğŸ”„ **æµç¨‹æ ‡å‡†åŒ–**ï¼šç¡®ä¿æ“ä½œçš„ä¸€è‡´æ€§

## ğŸ› ï¸ RPA å·¥å…·ç®±é€‰æ‹©

### 1. PyAutoGUI - æ¡Œé¢åº”ç”¨æ§åˆ¶
```python
import pyautogui
import time

# å®‰å…¨è®¾ç½®ï¼šé¼ æ ‡ç§»åŠ¨åˆ°å±å¹•è§’è½ä¼šè§¦å‘å¼‚å¸¸
pyautogui.FAILSAFE = True

# å±å¹•æˆªå›¾
screenshot = pyautogui.screenshot()
screenshot.save('screen.png')

# é¼ æ ‡æ“ä½œ
pyautogui.moveTo(100, 200, duration=0.5)  # ç§»åŠ¨é¼ æ ‡
pyautogui.click(100, 200)  # ç‚¹å‡»
pyautogui.doubleClick(100, 200)  # åŒå‡»
pyautogui.rightClick(100, 200)  # å³é”®

# é”®ç›˜æ“ä½œ
pyautogui.typewrite('Hello World!', interval=0.1)  # è¾“å…¥æ–‡å­—
pyautogui.press('enter')  # æŒ‰å›è½¦
pyautogui.hotkey('ctrl', 'c')  # ç»„åˆé”®
```

### 2. Selenium - Web è‡ªåŠ¨åŒ–
```python
from selenium import webdriver
from selenium.webdriver.common.by import By
from selenium.webdriver.support.ui import WebDriverWait
from selenium.webdriver.support import expected_conditions as EC

# åˆå§‹åŒ–æµè§ˆå™¨
driver = webdriver.Chrome()
driver.get("https://example.com")

try:
    # ç­‰å¾…å…ƒç´ åŠ è½½
    element = WebDriverWait(driver, 10).until(
        EC.presence_of_element_located((By.ID, "username"))
    )

    # è¾“å…¥ç”¨æˆ·å
    element.send_keys("your_username")

    # ç‚¹å‡»ç™»å½•æŒ‰é’®
    login_button = driver.find_element(By.XPATH, "//button[@type='submit']")
    login_button.click()

    # ç­‰å¾…é¡µé¢è·³è½¬
    WebDriverWait(driver, 10).until(
        EC.title_contains("Dashboard")
    )

    print("ç™»å½•æˆåŠŸï¼")

finally:
    driver.quit()
```

### 3. ä¼ä¸šçº§ RPA æ¡†æ¶è®¾è®¡

```python
import logging
from abc import ABC, abstractmethod
from typing import Dict, Any, Optional
from datetime import datetime

class BaseRPA(ABC):
    """RPA åŸºç¡€ç±»"""

    def __init__(self, name: str):
        self.name = name
        self.logger = self._setup_logger()
        self.start_time = None
        self.result = {}

    def _setup_logger(self):
        """è®¾ç½®æ—¥å¿—è®°å½•"""
        logger = logging.getLogger(self.name)
        logger.setLevel(logging.INFO)

        handler = logging.StreamHandler()
        formatter = logging.Formatter(
            '%(asctime)s - %(name)s - %(levelname)s - %(message)s'
        )
        handler.setFormatter(formatter)
        logger.addHandler(handler)

        return logger

    def start(self):
        """å¼€å§‹æ‰§è¡Œ"""
        self.start_time = datetime.now()
        self.logger.info(f"å¼€å§‹æ‰§è¡Œ {self.name}")

        try:
            self.result = self.execute()
            self.logger.info(f"{self.name} æ‰§è¡ŒæˆåŠŸ")
            return True
        except Exception as e:
            self.logger.error(f"{self.name} æ‰§è¡Œå¤±è´¥: {e}")
            return False
        finally:
            self._log_summary()

    @abstractmethod
    def execute(self) -> Dict[str, Any]:
        """æ‰§è¡Œå…·ä½“çš„è‡ªåŠ¨åŒ–ä»»åŠ¡"""
        pass

    def _log_summary(self):
        """è®°å½•æ‰§è¡Œæ‘˜è¦"""
        if self.start_time:
            duration = datetime.now() - self.start_time
            self.logger.info(f"æ‰§è¡Œè€—æ—¶: {duration}")
```

## ğŸ¢ å®æˆ˜é¡¹ç›®ï¼šæ™ºèƒ½æŠ¥è¡¨ç”Ÿæˆå™¨

### éœ€æ±‚åœºæ™¯
æ¯å¤©ä»å¤šä¸ªç³»ç»Ÿå¯¼å‡ºæ•°æ®ï¼Œæ•´åˆåˆ° Excel æŠ¥è¡¨ä¸­ï¼Œå¹¶å‘é€ç»™ç›¸å…³äººå‘˜ã€‚

![æ•°æ®å¤„ç†æµç¨‹](https://images.unsplash.com/photo-1551288049-bebda4e38f71?w=800&h=400&fit=crop&crop=entropy&auto=format)

### å®Œæ•´å®ç°

```python
import pandas as pd
import smtplib
from email.mime.multipart import MIMEMultipart
from email.mime.text import MIMEText
from email.mime.base import MIMEBase
from email import encoders
import os
from datetime import datetime, timedelta

class ReportGeneratorRPA(BaseRPA):
    """æ™ºèƒ½æŠ¥è¡¨ç”Ÿæˆå™¨"""

    def __init__(self):
        super().__init__("æ™ºèƒ½æŠ¥è¡¨ç”Ÿæˆå™¨")
        self.data_sources = {
            'sales': 'https://internal-api.com/sales',
            'inventory': 'https://internal-api.com/inventory',
            'hr': 'https://internal-api.com/hr'
        }
        self.recipients = ['manager@company.com', 'team@company.com']

    def execute(self) -> Dict[str, Any]:
        """æ‰§è¡ŒæŠ¥è¡¨ç”Ÿæˆæµç¨‹"""
        results = {}

        # 1. æ•°æ®é‡‡é›†
        raw_data = self._collect_data()
        results['data_collection'] = 'success'

        # 2. æ•°æ®å¤„ç†
        processed_data = self._process_data(raw_data)
        results['data_processing'] = 'success'

        # 3. æŠ¥è¡¨ç”Ÿæˆ
        report_path = self._generate_report(processed_data)
        results['report_generation'] = 'success'

        # 4. é‚®ä»¶å‘é€
        self._send_report_email(report_path)
        results['email_sent'] = 'success'

        return results

    def _collect_data(self) -> Dict[str, pd.DataFrame]:
        """é‡‡é›†å„ç³»ç»Ÿæ•°æ®"""
        self.logger.info("å¼€å§‹é‡‡é›†æ•°æ®...")

        data = {}
        for source, url in self.data_sources.items():
            try:
                # æ¨¡æ‹Ÿ API è°ƒç”¨
                df = self._fetch_api_data(url)
                data[source] = df
                self.logger.info(f"{source} æ•°æ®é‡‡é›†å®Œæˆ")
            except Exception as e:
                self.logger.error(f"{source} æ•°æ®é‡‡é›†å¤±è´¥: {e}")
                # ä½¿ç”¨å¤‡ç”¨æ•°æ®
                data[source] = self._get_backup_data(source)

        return data

    def _fetch_api_data(self, url: str) -> pd.DataFrame:
        """è·å– API æ•°æ®ï¼ˆç¤ºä¾‹ï¼‰"""
        import requests

        headers = {
            'Authorization': 'Bearer your-token',
            'Content-Type': 'application/json'
        }

        response = requests.get(url, headers=headers)
        response.raise_for_status()

        return pd.DataFrame(response.json())

    def _get_backup_data(self, source: str) -> pd.DataFrame:
        """è·å–å¤‡ç”¨æ•°æ®"""
        backup_data = {
            'sales': pd.DataFrame({
                'date': pd.date_range(end=datetime.now(), periods=30),
                'amount': range(10000, 100000, 3000),
                'product': ['Product A', 'Product B', 'Product C'] * 10
            }),
            'inventory': pd.DataFrame({
                'product': ['A', 'B', 'C', 'D', 'E'],
                'quantity': [100, 200, 150, 300, 250],
                'price': [10, 20, 15, 30, 25]
            }),
            'hr': pd.DataFrame({
                'department': ['IT', 'Sales', 'HR', 'Finance'],
                'employees': [15, 25, 8, 12],
                'avg_salary': [8000, 6000, 5000, 7000]
            })
        }

        return backup_data.get(source, pd.DataFrame())

    def _process_data(self, raw_data: Dict[str, pd.DataFrame]) -> Dict[str, Any]:
        """å¤„ç†å’Œæ•´åˆæ•°æ®"""
        self.logger.info("å¼€å§‹å¤„ç†æ•°æ®...")

        processed = {}

        # é”€å”®æ•°æ®åˆ†æ
        sales_df = raw_data['sales']
        processed['sales_summary'] = {
            'total_revenue': sales_df['amount'].sum(),
            'daily_average': sales_df['amount'].mean(),
            'top_product': sales_df.groupby('product')['amount'].sum().idxmax()
        }

        # åº“å­˜åˆ†æ
        inventory_df = raw_data['inventory']
        processed['inventory_summary'] = {
            'total_products': len(inventory_df),
            'total_value': (inventory_df['quantity'] * inventory_df['price']).sum(),
            'low_stock': inventory_df[inventory_df['quantity'] < 200]['product'].tolist()
        }

        # äººåŠ›èµ„æºåˆ†æ
        hr_df = raw_data['hr']
        processed['hr_summary'] = {
            'total_employees': hr_df['employees'].sum(),
            'avg_salary': (hr_df['employees'] * hr_df['avg_salary']).sum() / hr_df['employees'].sum()
        }

        return processed

    def _generate_report(self, data: Dict[str, Any]) -> str:
        """ç”Ÿæˆ Excel æŠ¥è¡¨"""
        self.logger.info("ç”ŸæˆæŠ¥è¡¨...")

        # åˆ›å»º Excel æ–‡ä»¶
        report_path = f"daily_report_{datetime.now().strftime('%Y%m%d')}.xlsx"

        with pd.ExcelWriter(report_path, engine='openpyxl') as writer:
            # æ€»è§ˆé¡µ
            overview_data = {
                'æŒ‡æ ‡': ['æ€»æ”¶å…¥', 'æ—¥å‡æ”¶å…¥', 'çƒ­é”€äº§å“', 'åº“å­˜æ€»å€¼', 'å‘˜å·¥æ€»æ•°', 'å¹³å‡è–ªèµ„'],
                'æ•°å€¼': [
                    data['sales_summary']['total_revenue'],
                    data['sales_summary']['daily_average'],
                    data['sales_summary']['top_product'],
                    data['inventory_summary']['total_value'],
                    data['hr_summary']['total_employees'],
                    data['hr_summary']['avg_salary']
                ]
            }
            pd.DataFrame(overview_data).to_excel(writer, sheet_name='æ€»è§ˆ', index=False)

            # æ˜ç»†æ•°æ®
            # è¿™é‡Œå¯ä»¥æ·»åŠ æ›´å¤šè¯¦ç»†æ•°æ®è¡¨

        self.logger.info(f"æŠ¥è¡¨ç”Ÿæˆå®Œæˆ: {report_path}")
        return report_path

    def _send_report_email(self, report_path: str):
        """å‘é€æŠ¥è¡¨é‚®ä»¶"""
        self.logger.info("å‘é€é‚®ä»¶...")

        # åˆ›å»ºé‚®ä»¶
        msg = MIMEMultipart()
        msg['From'] = 'rpa-bot@company.com'
        msg['To'] = ', '.join(self.recipients)
        msg['Subject'] = f"æ¯æ—¥ä¸šåŠ¡æŠ¥è¡¨ - {datetime.now().strftime('%Yå¹´%mæœˆ%dæ—¥')}"

        # é‚®ä»¶æ­£æ–‡
        body = f"""
        æ‚¨å¥½ï¼

        è¿™æ˜¯ä»Šæ—¥çš„ä¸šåŠ¡æŠ¥è¡¨ï¼Œè¯·æŸ¥æ”¶é™„ä»¶ã€‚

        æŠ¥è¡¨ç”Ÿæˆæ—¶é—´: {datetime.now().strftime('%Y-%m-%d %H:%M:%S')}

        å¦‚æœ‰é—®é¢˜ï¼Œè¯·è”ç³» IT éƒ¨é—¨ã€‚

        æ­¤é‚®ä»¶ç”± RPA æœºå™¨äººè‡ªåŠ¨å‘é€ï¼Œè¯·å‹¿å›å¤ã€‚
        """

        msg.attach(MIMEText(body, 'plain'))

        # é™„ä»¶
        with open(report_path, 'rb') as attachment:
            part = MIMEBase('application', 'octet-stream')
            part.set_payload(attachment.read())

        encoders.encode_base64(part)
        part.add_header(
            'Content-Disposition',
            f'attachment; filename= {os.path.basename(report_path)}'
        )

        msg.attach(part)

        # å‘é€é‚®ä»¶
        with smtplib.SMTP('smtp.company.com', 587) as server:
            server.starttls()
            server.login('rpa-bot@company.com', 'password')
            server.send_message(msg)

        self.logger.info("é‚®ä»¶å‘é€æˆåŠŸ")

# ä½¿ç”¨ç¤ºä¾‹
if __name__ == "__main__":
    rpa_bot = ReportGeneratorRPA()
    success = rpa_bot.start()

    if success:
        print("RPA ä»»åŠ¡æ‰§è¡ŒæˆåŠŸï¼")
    else:
        print("RPA ä»»åŠ¡æ‰§è¡Œå¤±è´¥ï¼Œè¯·æ£€æŸ¥æ—¥å¿—ã€‚")
```

## ğŸš€ é«˜çº§æŠ€å·§

### 1. å¼‚å¸¸å¤„ç†ä¸é‡è¯•æœºåˆ¶
```python
import time
from functools import wraps

def retry(max_attempts=3, delay=1):
    """é‡è¯•è£…é¥°å™¨"""
    def decorator(func):
        @wraps(func)
        def wrapper(*args, **kwargs):
            for attempt in range(max_attempts):
                try:
                    return func(*args, **kwargs)
                except Exception as e:
                    if attempt == max_attempts - 1:
                        raise e
                    time.sleep(delay * (2 ** attempt))  # æŒ‡æ•°é€€é¿
            return None
        return wrapper
    return decorator

class RobustRPA(BaseRPA):
    """å¢å¼ºç‰ˆ RPAï¼Œå¸¦é‡è¯•æœºåˆ¶"""

    @retry(max_attempts=3, delay=2)
    def _click_element(self, element):
        """ç‚¹å‡»å…ƒç´ ï¼Œå¸¦é‡è¯•"""
        element.click()

    @retry(max_attempts=3, delay=1)
    def _send_keys(self, element, text):
        """è¾“å…¥æ–‡æœ¬ï¼Œå¸¦é‡è¯•"""
        element.clear()
        element.send_keys(text)
```

### 2. é…ç½®ç®¡ç†
```python
import yaml
from dataclasses import dataclass
from typing import List

@dataclass
class RPAConfig:
    """RPA é…ç½®ç±»"""
    name: str
    schedule: str
    recipients: List[str]
    data_sources: Dict[str, str]
    retry_attempts: int = 3
    timeout: int = 30

def load_config(config_path: str) -> RPAConfig:
    """åŠ è½½é…ç½®æ–‡ä»¶"""
    with open(config_path, 'r', encoding='utf-8') as f:
        data = yaml.safe_load(f)

    return RPAConfig(**data)
```

### 3. ç›‘æ§ä¸å‘Šè­¦
```python
class RPAMonitor:
    """RPA ç›‘æ§ç±»"""

    def __init__(self):
        self.alerts = []

    def check_execution_time(self, rpa_instance, max_duration_minutes=30):
        """æ£€æŸ¥æ‰§è¡Œæ—¶é—´"""
        if rpa_instance.start_time:
            duration = datetime.now() - rpa_instance.start_time
            if duration.total_seconds() > max_duration_minutes * 60:
                self.send_alert(f"{rpa_instance.name} æ‰§è¡Œæ—¶é—´è¿‡é•¿: {duration}")

    def send_alert(self, message):
        """å‘é€å‘Šè­¦"""
        # å‘é€åˆ°ä¼ä¸šå¾®ä¿¡ã€é’‰é’‰æˆ–é‚®ä»¶
        print(f"ALERT: {message}")
        self.alerts.append(message)
```

## ğŸ“Š æ€§èƒ½ä¼˜åŒ–

### 1. å¹¶è¡Œå¤„ç†
```python
import concurrent.futures
from multiprocessing import Pool

class ParallelRPA(BaseRPA):
    """å¹¶è¡Œ RPA"""

    def execute(self):
        tasks = [
            self._collect_sales_data,
            self._collect_inventory_data,
            self._collect_hr_data
        ]

        with concurrent.futures.ThreadPoolExecutor(max_workers=3) as executor:
            futures = [executor.submit(task) for task in tasks]
            results = [future.result() for future in futures]

        return self._merge_results(results)
```

### 2. ç¼“å­˜æœºåˆ¶
```python
import pickle
import hashlib

class CacheRPA(BaseRPA):
    """å¸¦ç¼“å­˜çš„ RPA"""

    def __init__(self):
        super().__init__()
        self.cache_dir = "cache"
        os.makedirs(self.cache_dir, exist_ok=True)

    def _get_cache_key(self, data):
        """ç”Ÿæˆç¼“å­˜é”®"""
        return hashlib.md5(str(data).encode()).hexdigest()

    def _get_cached_data(self, key):
        """è·å–ç¼“å­˜æ•°æ®"""
        cache_file = os.path.join(self.cache_dir, f"{key}.pkl")
        if os.path.exists(cache_file):
            with open(cache_file, 'rb') as f:
                return pickle.load(f)
        return None

    def _save_cache(self, key, data):
        """ä¿å­˜ç¼“å­˜æ•°æ®"""
        cache_file = os.path.join(self.cache_dir, f"{key}.pkl")
        with open(cache_file, 'wb') as f:
            pickle.dump(data, f)
```

## ğŸ“ æœ€ä½³å®è·µ

### 1. å®‰å…¨æ€§
- ğŸ” æ•æ„Ÿä¿¡æ¯åŠ å¯†å­˜å‚¨
- ğŸ›¡ï¸ ç½‘ç»œè¯·æ±‚ä½¿ç”¨ HTTPS
- ğŸ”‘ å®šæœŸæ›´æ–° API å¯†é’¥
- ğŸ“ å®Œæ•´çš„æ“ä½œæ—¥å¿—

### 2. å¯ç»´æŠ¤æ€§
- ğŸ“¦ æ¨¡å—åŒ–è®¾è®¡
- ğŸ—ï¸ é…ç½®ä¸ä»£ç åˆ†ç¦»
- ğŸ“š å®Œå–„çš„æ–‡æ¡£
- ğŸ§ª å•å…ƒæµ‹è¯•è¦†ç›–

### 3. å¯æ‰©å±•æ€§
- ğŸ”Œ æ’ä»¶åŒ–æ¶æ„
- ğŸ“¡ å¾®æœåŠ¡åŒ–éƒ¨ç½²
- ğŸ”„ ç‰ˆæœ¬æ§åˆ¶
- ğŸ“ˆ æ€§èƒ½ç›‘æ§

## ğŸ¯ æ€»ç»“

é€šè¿‡è¿™ä¸ªå®æˆ˜é¡¹ç›®ï¼Œæˆ‘ä»¬æ„å»ºäº†ä¸€ä¸ªå®Œæ•´çš„ä¼ä¸šçº§ RPA ç³»ç»Ÿï¼š

âœ… **åŸºç¡€èƒ½åŠ›**ï¼šPyAutoGUI + Selenium åŒå¼•æ“
âœ… **ä¼ä¸šçº§æ¶æ„**ï¼šåŸºç±»è®¾è®¡ã€é…ç½®ç®¡ç†ã€å¼‚å¸¸å¤„ç†
âœ… **å®æˆ˜åº”ç”¨**ï¼šæ™ºèƒ½æŠ¥è¡¨ç”Ÿæˆã€é‚®ä»¶å‘é€
âœ… **é«˜çº§ç‰¹æ€§**ï¼šé‡è¯•æœºåˆ¶ã€ç¼“å­˜ä¼˜åŒ–ã€å¹¶è¡Œå¤„ç†
âœ… **æœ€ä½³å®è·µ**ï¼šå®‰å…¨æ€§ã€å¯ç»´æŠ¤æ€§ã€å¯æ‰©å±•æ€§

è¿™ä¸ª RPA ç³»ç»Ÿå¯ä»¥è½»æ¾æ‰©å±•åˆ°å…¶ä»–ä¸šåŠ¡åœºæ™¯ï¼Œè®©ä½ çš„å·¥ä½œæ•ˆç‡æå‡ 10 å€ï¼

---

**ä¸‹ä¸€ç¯‡é¢„å‘Š**ï¼šã€ŠAI Agent å¼€å‘æŒ‡å—ï¼šç”¨ LangChain æ„å»ºæ™ºèƒ½åŠ©æ‰‹ã€‹

å‡†å¤‡å¥½è¿›å…¥ AI Agent çš„ä¸–ç•Œäº†å—ï¼ŸğŸš€